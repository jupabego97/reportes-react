{% comment %}
  Customer Registration Page - NANO Tech Store 2026
{% endcomment %}

<section class="auth-section">
  <div class="auth-container">
    <div class="auth-card">
      <!-- Header -->
      <header class="auth-header">
        <div class="auth-logo">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
            <circle cx="8.5" cy="7" r="4"/>
            <line x1="20" y1="8" x2="20" y2="14"/>
            <line x1="23" y1="11" x2="17" y2="11"/>
          </svg>
        </div>
        <h1 class="auth-title">Crear Cuenta</h1>
        <p class="auth-subtitle">Únete a la comunidad NANO</p>
      </header>

      <!-- Register Form -->
      {%- form 'create_customer', class: 'auth-form' -%}
        {%- if form.errors -%}
          <div class="auth-error">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="15" y1="9" x2="9" y2="15"/>
              <line x1="9" y1="9" x2="15" y2="15"/>
            </svg>
            <span>{{ form.errors | default_errors }}</span>
          </div>
        {%- endif -%}

        <div class="form-row">
          <div class="form-group">
            <label for="FirstName" class="form-label">Nombre</label>
            <div class="input-wrapper">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                <circle cx="12" cy="7" r="4"/>
              </svg>
              <input
                type="text"
                name="customer[first_name]"
                id="FirstName"
                class="form-input"
                autocomplete="given-name"
                placeholder="Tu nombre"
                required
              >
            </div>
          </div>

          <div class="form-group">
            <label for="LastName" class="form-label">Apellido</label>
            <div class="input-wrapper">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                <circle cx="12" cy="7" r="4"/>
              </svg>
              <input
                type="text"
                name="customer[last_name]"
                id="LastName"
                class="form-input"
                autocomplete="family-name"
                placeholder="Tu apellido"
                required
              >
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="Email" class="form-label">Correo electrónico</label>
          <div class="input-wrapper">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
              <polyline points="22,6 12,13 2,6"/>
            </svg>
            <input
              type="email"
              name="customer[email]"
              id="Email"
              class="form-input"
              autocomplete="email"
              autocapitalize="off"
              autocorrect="off"
              placeholder="tu@email.com"
              required
            >
          </div>
        </div>

        <div class="form-group">
          <label for="Password" class="form-label">Contraseña</label>
          <div class="input-wrapper">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
            <input
              type="password"
              name="customer[password]"
              id="Password"
              class="form-input"
              autocomplete="new-password"
              placeholder="Mínimo 5 caracteres"
              minlength="5"
              required
            >
            <button type="button" class="password-toggle" aria-label="Mostrar contraseña">
              <svg class="eye-open" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
              <svg class="eye-closed" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none;">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                <line x1="1" y1="1" x2="23" y2="23"/>
              </svg>
            </button>
          </div>
          <p class="form-hint">La contraseña debe tener al menos 5 caracteres</p>
        </div>

        <!-- Benefits -->
        <div class="register-benefits">
          <h3 class="benefits-title">Beneficios de crear una cuenta:</h3>
          <ul class="benefits-list">
            <li>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
              <span>Seguimiento de tus pedidos en tiempo real</span>
            </li>
            <li>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
              <span>Acceso a ofertas exclusivas</span>
            </li>
            <li>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
              <span>Compras más rápidas con datos guardados</span>
            </li>
            <li>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
              <span>Historial completo de tus compras</span>
            </li>
          </ul>
        </div>

        <button type="submit" class="btn btn--primary btn--full auth-submit">
          <span>Crear cuenta</span>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </button>

        <p class="terms-text">
          Al crear una cuenta, aceptas nuestros 
          <a href="{{ pages['terminos-y-condiciones'].url | default: '#' }}">Términos y Condiciones</a> 
          y nuestra 
          <a href="{{ pages['politica-de-privacidad'].url | default: '#' }}">Política de Privacidad</a>.
        </p>
      {%- endform -%}

      <!-- Divider -->
      <div class="auth-divider">
        <span>¿Ya tienes cuenta?</span>
      </div>

      <!-- Login Link -->
      <a href="{{ routes.account_login_url }}" class="btn btn--secondary btn--full">
        Iniciar sesión
      </a>

      <!-- Back to store -->
      <a href="{{ routes.root_url }}" class="back-to-store">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
        Volver a la tienda
      </a>
    </div>
  </div>
</section>

<style>
  .auth-section {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-8) var(--space-4);
    background: linear-gradient(135deg, var(--color-bg) 0%, var(--color-bg-alt) 100%);
  }

  .auth-container {
    width: 100%;
    max-width: 500px;
  }

  .auth-card {
    background: var(--color-surface);
    border-radius: var(--radius-2xl);
    padding: var(--space-10);
    box-shadow: var(--shadow-xl);
    border: 1px solid var(--color-border);
  }

  .auth-header {
    text-align: center;
    margin-bottom: var(--space-8);
  }

  .auth-logo {
    width: 80px;
    height: 80px;
    margin: 0 auto var(--space-4);
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-secondary) 100%);
    border-radius: var(--radius-full);
    color: white;
  }

  .auth-title {
    font-family: var(--font-heading);
    font-size: var(--text-3xl);
    font-weight: 700;
    color: var(--color-text);
    margin: 0 0 var(--space-2);
  }

  .auth-subtitle {
    font-size: var(--text-base);
    color: var(--color-text-secondary);
    margin: 0;
  }

  .auth-form {
    display: flex;
    flex-direction: column;
    gap: var(--space-5);
  }

  .auth-error {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-4);
    border-radius: var(--radius-lg);
    font-size: var(--text-sm);
    font-weight: 500;
    background: var(--color-error-light);
    color: var(--color-error);
    border: 1px solid var(--color-error);
  }

  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-4);
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }

  .form-label {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--color-text);
  }

  .input-wrapper {
    position: relative;
    display: flex;
    align-items: center;
  }

  .input-wrapper svg:first-child {
    position: absolute;
    left: var(--space-4);
    color: var(--color-text-muted);
    pointer-events: none;
    z-index: 1;
  }

  .form-input {
    width: 100%;
    padding: var(--space-4) var(--space-4) var(--space-4) var(--space-12);
    background: var(--color-bg-alt);
    border: 2px solid transparent;
    border-radius: var(--radius-lg);
    font-size: var(--text-base);
    font-family: var(--font-body);
    color: var(--color-text);
    transition: all var(--transition-fast);
  }

  .form-input:focus {
    outline: none;
    border-color: var(--color-accent);
    background: var(--color-surface);
    box-shadow: 0 0 0 4px var(--color-accent-glow);
  }

  .form-input::placeholder {
    color: var(--color-text-muted);
  }

  .password-toggle {
    position: absolute;
    right: var(--space-4);
    background: none;
    border: none;
    color: var(--color-text-muted);
    cursor: pointer;
    padding: var(--space-1);
    transition: color var(--transition-fast);
  }

  .password-toggle:hover {
    color: var(--color-accent);
  }

  .form-hint {
    font-size: var(--text-xs);
    color: var(--color-text-muted);
    margin: 0;
  }

  /* Benefits */
  .register-benefits {
    background: var(--color-bg-alt);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    margin-top: var(--space-2);
  }

  .benefits-title {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--color-text);
    margin: 0 0 var(--space-3);
  }

  .benefits-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }

  .benefits-list li {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-size: var(--text-sm);
    color: var(--color-text-secondary);
  }

  .benefits-list li svg {
    color: var(--color-success);
    flex-shrink: 0;
  }

  .auth-submit {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    padding: var(--space-4) var(--space-6);
    font-size: var(--text-base);
    font-weight: 600;
    margin-top: var(--space-2);
  }

  .terms-text {
    font-size: var(--text-xs);
    color: var(--color-text-muted);
    text-align: center;
    margin: 0;
    line-height: 1.5;
  }

  .terms-text a {
    color: var(--color-accent);
    text-decoration: underline;
  }

  .terms-text a:hover {
    color: var(--color-accent-hover);
  }

  .auth-divider {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    margin: var(--space-6) 0;
  }

  .auth-divider::before,
  .auth-divider::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--color-border);
  }

  .auth-divider span {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    white-space: nowrap;
  }

  .back-to-store {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    margin-top: var(--space-6);
    font-size: var(--text-sm);
    color: var(--color-text-secondary);
    transition: color var(--transition-fast);
  }

  .back-to-store:hover {
    color: var(--color-accent);
  }

  /* Responsive */
  @media (max-width: 480px) {
    .auth-card {
      padding: var(--space-6);
    }

    .auth-title {
      font-size: var(--text-2xl);
    }

    .form-row {
      grid-template-columns: 1fr;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Password toggle
    const passwordToggles = document.querySelectorAll('.password-toggle');
    passwordToggles.forEach(toggle => {
      toggle.addEventListener('click', function() {
        const input = this.parentElement.querySelector('input');
        const eyeOpen = this.querySelector('.eye-open');
        const eyeClosed = this.querySelector('.eye-closed');
        
        if (input.type === 'password') {
          input.type = 'text';
          eyeOpen.style.display = 'none';
          eyeClosed.style.display = 'block';
        } else {
          input.type = 'password';
          eyeOpen.style.display = 'block';
          eyeClosed.style.display = 'none';
        }
      });
    });
  });
</script>
